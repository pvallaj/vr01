<div class="marco" fxFlex fxLayout="column" fxLayoutAlign="first stretch" fxFill>
    <form [formGroup]="frm" class="consulta" [style.display]="despResultado" fxLayout="row wrap" fxLayoutGap="10px" fxLayoutAlign="space-between stretch">
        <mat-form-field class="ac">
            <input type="text" placeholder="Selecciona un autor" aria-label="Number" matInput [formControl]="acAutores" [matAutocomplete]="auto" (change)="cambioAutor()">
            <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let autor of listaFiltrada | async" [value]="autor">
                    {{autor}}
                </mat-option>
            </mat-autocomplete>
        </mat-form-field>
        <mat-form-field class="tituloSermon">
            <input matInput type="text" placeholder="En el titulo del sermón" formControlName="titulo">
            <button mat-button matSuffix mat-icon-button aria-label="Clear">
                <mat-icon>close</mat-icon>
            </button>
        </mat-form-field>

        <mat-form-field class="anio">
            <input matInput type="text" placeholder="Año de publicacion sermón INICIAL" formControlName="anio_ini">
        </mat-form-field>
        <mat-form-field class="anio">
            <input matInput type="text" placeholder="Año de publicacion sermón, FINAL " formControlName="anio_fin">
        </mat-form-field>

        <mat-form-field class="impresor" appearance="fill">
            <mat-label>Impresor</mat-label>
            <mat-select>
                <mat-option *ngFor="let elemento of listaImpresores" [value]="elemento.id_impresor">
                    {{elemento.impresor_nombre}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field class="preliminares" appearance="fill">
            <mat-label>Preliminares</mat-label>
            <mat-select>
                <mat-option>Ninguno</mat-option>
                <mat-option *ngFor="let elemento of listaPreliminares" [value]="elemento.id_autor">
                    {{elemento.autor}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field class="dedicatarios" appearance="fill">
            <mat-label>Dedicatarios</mat-label>
            <mat-select>
                <mat-option>Ninguno</mat-option>
                <mat-option *ngFor="let elemento of listaDedicatarios" [value]="elemento.id_dedicatario">
                    {{elemento.autor}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field class="ciudad" appearance="fill">
            <mat-label>Ciudad</mat-label>
            <mat-select>
                <mat-option>Ninguno</mat-option>
                <mat-option *ngFor="let elemento of listaCiudades" [value]="elemento.ciudad">
                    {{elemento.ciudad}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field class="tituloObra" appearance="fill">
            <mat-label>Titulo de la Obra</mat-label>
            <mat-select>
                <mat-option>Ninguno</mat-option>
                <mat-option *ngFor="let elemento of listaObras" [value]="elemento.id_libro">
                    {{elemento.libro_titulo}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field class="orden" appearance="fill">
            <mat-label>Orden Religiosa</mat-label>
            <mat-select>
                <mat-option>Ninguno</mat-option>
                <mat-option *ngFor="let elemento of listaOrdenesReligiosas" [value]="elemento.autor_orden">
                    {{elemento.autor_orden}}
                </mat-option>
            </mat-select>
        </mat-form-field>
        <button mat-raised-button class="btnBuscar" (click)="consulta()">
            <mat-icon>search</mat-icon> BUSCAR
        </button>
    </form>
    <mat-card class="buscando" *ngIf="estaCargando">
        <mat-card-content>
            <h2 class="example-h2">Consultando base de datos</h2>

            <section class="example-section">
                <mat-progress-bar class="example-margin" [color]="'primary'" [mode]="'indeterminate'" [value]="50" [bufferValue]="100">
                </mat-progress-bar>
            </section>
        </mat-card-content>
    </mat-card>
    <div class="resultado" [style.display]="despResultado" *ngIf="!estaCargando">
        <div mat-subheader>Información encontrada en la base de datos</div>
        <div class="lista-resultado" fxLayout="row wrap" fxLayout.lt-sm="column" fxLayoutGap="10px" fxLayoutAlign="start">

            <mat-card class="tarjeta" *ngFor="let sermon of listaResultado; let i = index" fxFlex="0 0 calc(25% - 10px)" fxFlex.lt-md="0 0 calc(50% - 10px)" fxFlex.lt-sm="100%" (click)="idxSeleccionado=(i+1)">
                <mat-card-content [ngClass]="{'seleccionado':(i+1)==idxSeleccionado}" fxLayout="column" fxLayoutAlign="space-between">
                    <div fxFlex fxLayout fxLayoutAlign="space-between">
                        <p class="tituloTarjeta">{{i+1}} - {{sermon.autor_apellido}}, {{sermon.autor_nombre}}</p>
                        <button *ngIf="(i+1)==idxSeleccionado" mat-mini-fab color="primary" aria-label="Example icon button with a menu icon" (click)="cambiar(sermon.id_sermon)">
                            <mat-icon>menu</mat-icon>
                        </button>
                    </div>
                    <p>{{sermon.autor_particula}} {{sermon.titulo}}</p>
                    <p class="pieTarjeta">{{sermon.ciudad+', '+sermon.anio}}</p>
                </mat-card-content>
            </mat-card>

        </div>
    </div>
    <div class="detalle" [style.display]="despDetalle">
        <button mat-button class="regresar" (click)="cambiar(0)">
            <mat-icon>arrow_back_ios</mat-icon> Regresar
        </button>
        <app-cons-det-sermon [id_sermon]="id_sermon_sel" #detsermon></app-cons-det-sermon>
    </div>
</div>